{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Diego/Documents/Ecommers%20Don%20Rimos/client/src/app/admin/actualizar/page.jsx"],"sourcesContent":["'use client'\r\n\r\nimport { useEffect, useState } from \"react\"\r\n\r\nexport default function ActualizarProducto(){\r\n    const [productos, setProductos] = useState([]);\r\n    const [seleccionado, setSeleccionado] = useState(null);\r\n    const [formulario, setFormulario] = useState({\r\n        nombre: '',\r\n        descripcion: '',\r\n        precio: '',\r\n        categoria: '',\r\n        stock: '',\r\n    });\r\n    const [mensaje, setMensaje] = useState('');\r\n    const [imagenesSeleccionadas, setImagenesSeleccionadas] = useState([]);\r\n    const [previews, setPreviews] = useState([]);\r\n\r\n    useEffect(() => {\r\n        fetch('http://localhost:3001/api/productos')\r\n            .then(res => res.json())\r\n            .then(data => setProductos(data));\r\n    }, []);\r\n\r\n    const seleccionarProducto = (producto) => {\r\n        setSeleccionado(producto);\r\n        setFormulario({\r\n            nombre: producto.nombre,\r\n            descripcion:producto.descripcion,\r\n            precio: producto.precio,\r\n            categoria: producto.categoria,\r\n            stock: producto.stock\r\n        });\r\n        setPreviews(producto.imagenes ? JSON.parse(producto.imagenes) : []);\r\n    };\r\n\r\n    const handleChange = (e) => {\r\n        setFormulario({ ...formulario, [e.target.name]: e.target.value });\r\n    };\r\n\r\n    const handleImagenes = (e) => {\r\n        const archivos = Array.from(e.target.files);\r\n        setImagenesSeleccionadas(archivos);\r\n        const previews = archivos.map(archivo => URL.createObjectURL(archivo));\r\n        setPreviews(previews);\r\n    }\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n\r\n        const formData = new FormData();\r\n        formData.append('nombre', formulario.nombre);\r\n        formData.append('descripcion', formulario.descripcion);\r\n        formData.append('precio', formulario.precio);\r\n        formData.append('categoria', formulario.categoria);\r\n        formData.append('stock', formulario.stock);\r\n\r\n        imagenesSeleccionadas.forEach((img) =>{\r\n            formData.append('imagenes', img);\r\n        });\r\n\r\n        try {\r\n            const res = await fetch(`http://localhost:3001/api/productos/${seleccionado.id}`,{\r\n                method: 'PUT',\r\n                body: formData,\r\n            });\r\n\r\n            if (res.ok) {\r\n                setMensaje('✅ Producto actualizado')\r\n            } else {\r\n                const data = await res.json();\r\n                setMensaje(`❌ Error: ${data.error || 'desconocido'}`)\r\n            }\r\n        } catch (err) {\r\n            console.error(err);\r\n            setMensaje('❌ Error de conexión');\r\n        }\r\n    };\r\n\r\n    return(\r\n        <main className=\"p-8 max-w-3xl mx-auto \">\r\n            <h1 className=\"text-2xl text-black text-center font-bold mb-4\">Actualizar Productos</h1>\r\n\r\n            <ul className=\"mb-6 space-y2\">\r\n                {productos.map(p => (\r\n                    <li \r\n                        key={p.id}\r\n                        onClick={() => seleccionarProducto(p)}\r\n                        className=\"cursor-pointer bg-orange-500 text-white hover:bg-orange-600 p-4 border rounded\"\r\n                    >\r\n                        {p.nombre}\r\n                    </li>\r\n                ))}\r\n            </ul>\r\n\r\n            \r\n            {seleccionado && (\r\n                \r\n                <form onSubmit={handleSubmit} className=\"grid gap-2 text-black\">\r\n                    <h2 className=\" text-black\">Nombre: </h2>\r\n                    <input \r\n                        type=\"text\"\r\n                        name=\"nombre\"\r\n                        placeholder=\"Nombre\"\r\n                        value={formulario.nombre}\r\n                        onChange={handleChange}\r\n                        className=\"border p-2 rounded\"\r\n                    />\r\n                    <h2 className=\" text-black\">Descripcion: </h2>\r\n                    <textarea\r\n                        name=\"descripcion\"\r\n                        placeholder=\"Descripcion\"\r\n                        value={formulario.descripcion}\r\n                        onChange={handleChange}\r\n                        className=\"border p-2 rounded\"\r\n                    />\r\n                    <h2 className=\" text-black\">Precio: </h2>\r\n                    <input \r\n                        type=\"number\"\r\n                        name=\"precio\"\r\n                        placeholder=\"Precio\"\r\n                        value={formulario.precio}\r\n                        onChange={handleChange}\r\n                        className=\"border p-2 rounded\"\r\n                    />\r\n                    <h2 className=\" text-black\">Categoría: </h2>\r\n                    <input \r\n                        type=\"text\"\r\n                        name=\"categoria\"\r\n                        placeholder=\"Categoría\"\r\n                        value={formulario.categoria}\r\n                        onChange={handleChange}\r\n                        className=\"border p-2 rounded\"\r\n                    />\r\n                    <h2 className=\" text-black\">Stock: </h2>\r\n                    <input \r\n                        type=\"number\"\r\n                        name=\"stock\"\r\n                        placeholder=\"Stock\"\r\n                        value={formulario.stock}\r\n                        onChange={handleChange}\r\n                        className=\"border p-2 rounded\"\r\n                    />\r\n\r\n                    <div className=\"flex flex-col gap-2\">\r\n                        <h2 className=\" text-black\">Seleccionar imagenes a actualizar (opcional): </h2>\r\n                        <div className=\"flex items-center gap-4\">\r\n                            <span className=\"text-gray-700 text-sm\">\r\n                                {imagenesSeleccionadas.length > 0 \r\n                                    ? imagenesSeleccionadas.map(f => f.name).join(',')\r\n                                    : 'Ningun archivo Seleccionado'\r\n                                }\r\n                            </span>\r\n                            \r\n                            <button \r\n                            type=\"button\"\r\n                            onClick={() => document.getElementById('inputArchivo').click()}\r\n                            className=\"bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded\"\r\n                            >\r\n                                Seleccionar Archivo\r\n                            </button>\r\n                            \r\n                            <input\r\n                            id=\"inputArchivo\"\r\n                            type=\"file\"\r\n                            multiple\r\n                            onChange={handleImagenes}\r\n                            accept=\"image/*\"\r\n                            required\r\n                            className=\"border p-2 rounded hidden\"\r\n                            />\r\n                        </div>\r\n\r\n                        <div className=\"grid grid-cols-3 gap-2 mt-2\">\r\n                            {previews.map((src, index) =>\r\n                            <img\r\n                                key={index}  \r\n                                src={src}\r\n                                alt={`Preview ${index}`}\r\n                                className=\"h-20 w-full object-cover border rounded\"\r\n                            />\r\n                            )}\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n                    <button type=\"submit\" className=\"bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600\">\r\n                        Guardar Cambios\r\n                    </button>\r\n                </form>\r\n            )}\r\n\r\n            {mensaje && <p className=\"mt-4 text-black text-center text-sm\">{mensaje}</p>}\r\n        </main>\r\n    )\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}